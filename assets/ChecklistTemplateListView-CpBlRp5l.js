import{d as j,n as c,c as L,C as H,o as s,a as n,k as t,q as p,t as _,y as r,F as E,l as V,f as T,H as Q,z as D,v as z,p as W,j as Z,_ as J}from"./index-C3usxq6_.js";import{a as F}from"./checklist-be4Ln-Mi.js";const K=k=>(W("data-v-8a6c51d6"),k=k(),Z(),k),X={class:"checklist-template-list-view"},Y={class:"header"},ee=K(()=>t("h2",null,"Checklist Templates",-1)),te={class:"header-actions"},le=K(()=>t("div",{class:"help-text"},"Klick auf Zeile zum Bearbeiten • Enter speichern • Escape abbrechen",-1)),ae={key:0,class:"loading"},se={key:1,class:"error"},ne={key:2,class:"templates-container"},oe={class:"phase-header"},ie={class:"phase-title"},ue=["onClick","disabled"],de={class:"templates-table"},ce=K(()=>t("thead",null,[t("tr",null,[t("th",null,"Aufgabe"),t("th",null,"Bereich"),t("th",null,"Phase"),t("th",null,"Erstellt"),t("th",null,"Aktionen")])],-1)),re=["onClick"],ve={key:1},pe={key:1},he=["onUpdate:modelValue"],fe=["value"],me={key:1},ye={class:"created-cell"},_e={key:0},ke={key:0,class:"action-buttons"},be=["disabled"],ge={key:1,class:"action-buttons"},we=["onClick"],Ce={key:0,class:"add-row"},Ee=["onUpdate:modelValue"],Ve=["value"],Te=K(()=>t("td",{class:"created-cell"},[t("span",{class:"muted"},"Neu")],-1)),De={class:"actions-cell"},Fe={class:"action-buttons"},Ke=["disabled"],Ne={key:0,class:"empty"},Ae={key:0,class:"empty"},Le=j({__name:"ChecklistTemplateListView",setup(k){const h=c(null),b=c(!1),g=c(""),w=c(""),d=c(null),i=c({}),v=c(null),u=c({name:"",stage:"",phase:"before"}),f=c(!1),N=L(()=>{var l;return((l=h.value)==null?void 0:l.results)||[]}),M=L(()=>{if(!w.value)return N.value;const l=w.value.toLowerCase();return N.value.filter(e=>e.name.toLowerCase().includes(l)||e.stage.toLowerCase().includes(l))}),O=L(()=>{const l={before:[],during:[],after:[]};return M.value.forEach(e=>{l[e.phase].push(e)}),l}),S={before:"BEFORE - Vor der Veranstaltung",during:"DURING - Während der Veranstaltung",after:"AFTER - Nach der Veranstaltung"},U=[{value:"before",label:"BEFORE"},{value:"during",label:"DURING"},{value:"after",label:"AFTER"}];async function A(){b.value=!0,g.value="";try{h.value=await F.getAll()}catch(l){g.value=l.message||"Failed to load checklist templates"}finally{b.value=!1}}function P(l){d.value=l.id,i.value={...l},v.value=null}function B(){d.value=null,i.value={}}async function I(){if(!(!d.value||!i.value.name||!i.value.stage)){f.value=!0;try{await F.update(d.value,i.value),await A(),d.value=null,i.value={}}catch(l){alert("Failed to update template: "+l.message)}finally{f.value=!1}}}function $(l){v.value=l,u.value={name:"",stage:"",phase:l},d.value=null}function x(){v.value=null,u.value={name:"",stage:"",phase:"before"}}async function R(){if(!(!u.value.name||!u.value.stage)){f.value=!0;try{await F.create(u.value),await A(),v.value=null,u.value={name:"",stage:"",phase:"before"}}catch(l){alert("Failed to create template: "+l.message)}finally{f.value=!1}}}async function q(l){if(confirm(`Delete checklist template "${l.name}"?

Note: This will NOT affect existing events, only future events.`))try{await F.delete(l.id),h.value&&(h.value.results=h.value.results.filter(e=>e.id!==l.id),h.value.count--)}catch(e){alert("Failed to delete template: "+e.message)}}function m(l,e){l.key==="Enter"&&!l.shiftKey?(l.preventDefault(),e==="edit"?I():R()):l.key==="Escape"&&(l.preventDefault(),e==="edit"?B():x())}function G(l){return new Date(l).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})}return H(()=>{A()}),(l,e)=>(s(),n("div",X,[t("div",Y,[ee,t("div",te,[p(t("input",{class:"search-input","onUpdate:modelValue":e[0]||(e[0]=C=>w.value=C),type:"text",placeholder:"Search templates..."},null,512),[[_,w.value]])])]),le,b.value?(s(),n("div",ae,"Loading templates...")):g.value?(s(),n("div",se,r(g.value),1)):(s(),n("div",ne,[(s(!0),n(E,null,V(O.value,(C,y)=>(s(),n("div",{class:"phase-section",key:y},[t("div",oe,[t("h3",ie,r(S[y]),1),t("button",{class:"btn-add",onClick:a=>$(y),disabled:v.value===y},"+ Neu",8,ue)]),t("table",de,[ce,t("tbody",null,[(s(!0),n(E,null,V(C,a=>(s(),n("tr",{key:a.id,class:Q({editing:d.value===a.id}),onClick:o=>d.value===a.id?null:P(a)},[t("td",null,[d.value===a.id?p((s(),n("input",{key:0,class:"inline-input","onUpdate:modelValue":e[1]||(e[1]=o=>i.value.name=o),onClick:e[2]||(e[2]=D(()=>{},["stop"])),onKeydown:e[3]||(e[3]=o=>m(o,"edit")),placeholder:"Aufgabe",autofocus:""},null,544)),[[_,i.value.name]]):(s(),n("span",ve,r(a.name),1))]),t("td",null,[d.value===a.id?p((s(),n("input",{key:0,class:"inline-input","onUpdate:modelValue":e[4]||(e[4]=o=>i.value.stage=o),onClick:e[5]||(e[5]=D(()=>{},["stop"])),onKeydown:e[6]||(e[6]=o=>m(o,"edit")),placeholder:"Bereich"},null,544)),[[_,i.value.stage]]):(s(),n("span",pe,r(a.stage),1))]),t("td",null,[d.value===a.id?p((s(),n("select",{key:0,class:"inline-select","onUpdate:modelValue":o=>i.value.phase=o,onClick:e[7]||(e[7]=D(()=>{},["stop"])),onKeydown:e[8]||(e[8]=o=>m(o,"edit"))},[(s(),n(E,null,V(U,o=>t("option",{key:o.value,value:o.value},r(o.label),9,fe)),64))],40,he)),[[z,i.value.phase]]):(s(),n("span",me,r(S[a.phase]),1))]),t("td",ye,[a.created?(s(),n("span",_e,r(G(a.created)),1)):T("",!0)]),t("td",{class:"actions-cell",onClick:e[9]||(e[9]=D(()=>{},["stop"]))},[d.value===a.id?(s(),n("div",ke,[t("button",{class:"btn-save",onClick:I,disabled:f.value||!i.value.name||!i.value.stage},"Speichern",8,be),t("button",{class:"btn-cancel",onClick:B},"Abbrechen")])):(s(),n("div",ge,[t("button",{class:"btn-delete",onClick:o=>q(a)},"Löschen",8,we)]))])],10,re))),128)),v.value===y?(s(),n("tr",Ce,[t("td",null,[p(t("input",{class:"inline-input","onUpdate:modelValue":e[10]||(e[10]=a=>u.value.name=a),onKeydown:e[11]||(e[11]=a=>m(a,"add")),placeholder:"Neue Aufgabe...",autofocus:""},null,544),[[_,u.value.name]])]),t("td",null,[p(t("input",{class:"inline-input","onUpdate:modelValue":e[12]||(e[12]=a=>u.value.stage=a),onKeydown:e[13]||(e[13]=a=>m(a,"add")),placeholder:"Bereich"},null,544),[[_,u.value.stage]])]),t("td",null,[p(t("select",{class:"inline-select","onUpdate:modelValue":a=>u.value.phase=a,onKeydown:e[14]||(e[14]=a=>m(a,"add"))},[(s(),n(E,null,V(U,a=>t("option",{key:a.value,value:a.value},r(a.label),9,Ve)),64))],40,Ee),[[z,u.value.phase]])]),Te,t("td",De,[t("div",Fe,[t("button",{class:"btn-save",onClick:R,disabled:f.value||!u.value.name||!u.value.stage},"Speichern",8,Ke),t("button",{class:"btn-cancel",onClick:x},"Abbrechen")])])])):T("",!0)])]),!C.length&&v.value!==y?(s(),n("div",Ne,"Keine Templates für diese Phase")):T("",!0)]))),128)),!N.value.length&&!b.value?(s(),n("div",Ae,'Keine Checklist Templates vorhanden. Klicke "+ Neu" um eines zu erstellen.')):T("",!0)]))]))}}),Be=J(Le,[["__scopeId","data-v-8a6c51d6"]]);export{Be as default};
